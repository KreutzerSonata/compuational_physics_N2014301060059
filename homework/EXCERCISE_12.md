#Potentials and Fields  

Homework 5.4＆5.7

##Abstract  

In this task we encounter partial differential equations where Euler or Runge-Kutta method fails, as for the problem we are concerned
, the Laplace's equation, iteration algorithms is implemented, a relaxation method is introduced to solve the potential distrition of a parallel
plate capacitor, and the corresponding efficency is estimated.  

##Background  

In regions of space that do not contain any electric charges, the electric potential obeys Laplace's equation:  
![](https://camo.githubusercontent.com/14f3504467f9b8a0ce1ccac6c2707aca6744eab9/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543667261632537422535437061727469616c25354532253230562537442537422535437061727469616c253230782535453225374426706c75733b253543667261632537422535437061727469616c25354532253230562537442537422535437061727469616c253230792535453225374426706c75733b253543667261632537422535437061727469616c25354532253230562537442537422535437061727469616c2532307a2535453225374425334430)  
From which the components of E is derived as ![](https://camo.githubusercontent.com/fb8b870125cb7d973a85988a5b0231774d378b61/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f455f692533442d253543667261632537422535437061727469616c253230562537442537422535437061727469616c253230785f69253744). 
To get a numerical algrithms to the potential, these differential equations shall be reduced into difference form, before that, we
discretize the space into lattice, thus the potential at each site of the lattice is written as ![](https://camo.githubusercontent.com/fb2cea965b88fa229cf6e2de1e1cc1f0be77e1e6/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f56253238692532436a2532436b2532392535436571756976253230562532386925354344656c7461253230782532436a25354344656c7461253230792532436b25354344656c74612532307a253239) 
then it's convenient to get finite-difference form  
![](https://camo.githubusercontent.com/92236a3ed7e915db3d6f06d38d9858866a709633/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543626567696e253742616c69676e2a253744253230253543667261632537422535437061727469616c25354532253230562537442537422535437061727469616c2532307825354532253744253230253236253543617070726f78253230253543667261632537423125374425374225354344656c746125323078253744253542253543667261632537422535437061727469616c253230562537442537422535437061727469616c253230782537442532386926706c75733b2535436672616325374231253744253742322537442532392d253543667261632537422535437061727469616c253230562537442537422535437061727469616c25323078253744253238692d253543667261632537423125374425374232253744253239253544253230253543253543253230253236253543617070726f78253543667261632537423125374425374225354344656c74612532307825374425354225354366726163253742562532386926706c75733b312532436a2532436b2532392d56253238692532436a2532436b25323925374425374225354344656c7461253230782537442d2535436672616325374256253238692532436a2532436b2532392d56253238692d312532436a2532436b25323925374425374225354344656c746125323078253744253544253230253543253543253230253236253543617070726f7825323025354366726163253742562532386926706c75733b312532436a2532436b25323926706c75733b56253238692d312532436a2532436b2532392d3256253238692532436a2532436b25323925374425374225323825354344656c74612532307825323925354532253744253230253543656e64253742616c69676e2a253744)  
Results for the other two variables has the same form, insert them into Laplace's equation and get the solution  
![](https://camo.githubusercontent.com/3ae31660d933b6732ede4f83b6e711a469cce69f/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543626567696e253742616c69676e2a25374425323056253238692532436a2532436b253239253230253344253236253543667261632537423125374425374236253744253542562532386926706c75733b312532436a2532436b25323926706c75733b56253238692d312532436a2532436b25323926706c75733b56253238692532436a26706c75733b312532436b25323925354325354325323025323626706c75733b56253238692532436a2d312532436b25323926706c75733b56253238692532436a2532436b26706c75733b3125323926706c75733b56253238692532436a2532436b2d31253239253544253230253543656e64253742616c69676e2a253744)  
Now we are ready to do the computation.  

##Mainbody  

Laplace's equation differs from the previous ones we have encountered in the sense of its boundary condition instead of initial condition
. Actually from the finite-difference form of potential we see that the potential at any point is the average of V at all of the neighboring 
points, which implies the final equilibrium of the system. This allow us to randomly choose an inital condition, and use the previous
equation to do the iterations until specific accuracy is met.   

There are three different methods to do the iterations, Jacob method:  
![](http://latex.codecogs.com/gif.latex?V_%7Bnew%7D%3D%5Cfrac%7B1%7D%7B4%7D%5BV_%7Bold%7D%28i&plus;1%2Cj%29&plus;V_%7Bold%7D%28i-1%2Cj%29&plus;V_%7Bold%7D%28i%2Cj&plus;1%29&plus;V_%7Bold%7D%28i%2Cj-1%29%5D)   
Gauss-Seidel method:  
![](https://camo.githubusercontent.com/fbe33d9cdfa2b7ad2383671bfa33bf09d93156a6/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f565f2537426e6577253744253238692532436a253239253230253344253543667261632537423125374425374234253744253542565f2537426f6c642537442532386926706c75733b312532436a25323926706c75733b565f2537426e6577253744253238692d312532436a25323926706c75733b565f2537426f6c64253744253238692532436a26706c75733b3125323926706c75733b565f2537426e6577253744253238692532436a2d31253239253544)  
and the SOR(*Simultaneous Over-Relaxation*) method
![](https://camo.githubusercontent.com/2e701de04b352f385b4d166f2f861c94a7d29183/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f25354344656c746125323056253238692532436a2532392535436571756976253230562535452a253238692532436a2532392d565f2537426f6c64253744253238692532436a253239),
![](https://camo.githubusercontent.com/d76281e5e920aa312f53ee7d6b42afc08c00bbef/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f565f2537426e6577253744253238692532436a253239253344253543616c70686125354344656c746125323056253238692532436a25323926706c75733b565f2537426f6c64253744253238692532436a253239)  
where the factor α measures how much we “over-relax”. For a problem on a two-dimensional square grid, the best choice for is 
![](https://camo.githubusercontent.com/309b3ebef53833a38b96a23ac6081726198e278b/687474703a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543616c706861253543617070726f7825323025354366726163253742322537442537423126706c75733b25354370692f4c253744)  

For a fixed accuracy, the three methods produce the same result, the difference exists in their efficiency. We will see the SOR
method use the least number of iterations, we use it to solve the parallel plate capacitor problem.  
![](https://raw.githubusercontent.com/JunyiShangguan/computationalphysics_N2013301020076/master/ex13/1.png)  
Left plate held at V=1 and right plate V=-1, boundary held at V=0. The inner distrition of potential contours looks like  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential1.png)  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential1%203D.png)  
Separate the plates for a longer distance and the potential field changes as  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential2.png)  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential2%203D.png)  
Extend the length of plates and see the changes as  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential3.png)  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/potential3%203D.png)  
[code is here](https://github.com/KreutzerSonata/compuational_physics_N2014301060059/blob/master/code/SOR.py)  
We can see the fringing effect.  

Next we compare the dependence of the number of iterations on the number of gird element for a fixed accuracy. For Gauss-Seidel method, it changes as a sqaure dependence, while SOR method produces a simple linear dependence. Since the number of iterations reflects the speed of convergence, we say SOR is a more effective method.  
![](https://raw.githubusercontent.com/KreutzerSonata/compuational_physics_N2014301060059/master/diagrams/iteration.png)  
[code is here](https://github.com/KreutzerSonata/compuational_physics_N2014301060059/blob/master/code/iterations.py)  

##Acknowledgment and Reference  
参考吴雨桥的程序
